extends layout

block content
  h1 Hackathon Starter
  p.lead A boilerplate for Node.js web applications.
  hr
  .row
    .col-sm-6
      .container
        h4(style='color:#2196f3 !important') Weights
        br
        ul
          input(type='hidden', id="goals_json", value= JSON.stringify(locals))
  //jquery
  script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js')
  script.
    //console.log(db.weight.find().sort({"date":-1}));
    function get_pretty_date(value){
      var start_date = new Date(value)
      //start_date.setDate(start_date.getDate()+1);
      var s_year = start_date.getFullYear();
      var s_month = start_date.getMonth()+1;
      if(s_month <= 9)
          s_month = '0'+s_month;
      var s_day= start_date.getDate();
      if(s_day <= 9)
          s_day = '0'+s_day;
      var s_prettyDate = s_year +'-'+s_month +'-'+ s_day
      return s_prettyDate

    };
    var y_weight = [];
    var x_date = [];
    //bringing in the html element
    TESTER = document.getElementById('tester');
    var goals_json = document.getElementById("goals_json").value;
    var goals_json_value1 = JSON.parse(goals_json);
    for (var i = 0; i < goals_json_value1.weight.length; i++){
      //x_date_stg = (goals_json_value1.goal[count-1].createdAt).substring(0,10);
      var x_date_stg = get_pretty_date(goals_json_value1.weight[i].date)
      y_weight.push(goals_json_value1.weight[i].weight);
      x_date.push(x_date_stg);
      console.log(x_date);
      console.log(y_weight);
    }
  .container
    //centering logic: https://stackoverflow.com/questions/18153234/center-a-column-using-twitter-bootstrap-3
    .col-md-4.col-md-offset-4
      table.table.table-hover
        tr
          th(style='color:#333') Weight
          th(style='color:#333') Date

      script.
        var goals_json = document.getElementById("goals_json").value;
        var goals_json_value1 = JSON.parse(goals_json);
        console.log(goals_json_value1)
        //$(document).ready(function () {
        $.parseJSON(goals_json,
        function (json) {
        var tr;
        for (var i = 0; i < goals_json.length; i++) {
          tr = $('<tr>');
          var x_date_stg = get_pretty_date(goals_json_value1.weight[i].date);
          tr.append("<td>" + goals_json_value1.weight[i].weight+"</td>");
          tr.append("<td>" + x_date_stg+"</td>");
          $('table').append(tr);
        }
        });
